<div class="bento-sidebar">
    
    <div class="sidebar-section">
        <label class="modern-label ps-2">Workspaces</label>
        
        <ul class="list-unstyled d-flex flex-column gap-2 mb-0">
            @if ($workspaces | async; as workspaces) {
                @for (ws of workspaces; track ws.id) {
                    <li>
                        <!-- Workspace Toggle Button -->
                        <button class="btn-sidebar-toggle" 
                                (click)="toggleWorkspace(ws.id)" 
                                [class.active]="isExpanded(ws.id)">
                            
                            <div class="d-flex align-items-center gap-3" style="min-width: 0;">
                                <!-- Initials Box -->
                                <div class="icon-box flex-shrink-0">
                                    <span class="fw-bold">{{ ws.name.charAt(0) | uppercase }}</span>
                                </div>
                                <!-- Name -->
                                <span class="fw-bold text-truncate">{{ ws.name }}</span>
                            </div>

                            <!-- Chevron -->
                            <svg [class.rotate-chevron]="isExpanded(ws.id)" class="chevron flex-shrink-0" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                        </button>

                        <!-- Inner Content: Projects/Tasks -->
                        <div class="workspace-list-wrapper" [class.expanded]="isExpanded(ws.id)">
                            <ul class="list-unstyled mb-0 pt-2 pb-1 ps-3 ms-3 border-start border-2">
                                <li>
                                    <a class="workspace-item d-flex align-items-center gap-2 small">
                                        <svg class="text-secondary" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>
                                        Overview
                                    </a>
                                </li>
                                <li>
                                    <a class="workspace-item d-flex align-items-center gap-2 small">
                                        <svg class="text-secondary" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 6h13"/><path d="M8 12h13"/><path d="M8 18h13"/><path d="M3 6h.01"/><path d="M3 12h.01"/><path d="M3 18h.01"/></svg>
                                        Tasks
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </li>
                } @empty {
                    <li><span class="text-muted small ps-3">No workspaces found</span></li>
                }
            }
        </ul>
    </div>
</div>